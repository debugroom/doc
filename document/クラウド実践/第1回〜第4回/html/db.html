<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <title>DBイメージセットアップ手順書 &mdash; クラウド実践演習 0 documentation</title>

    <link rel="stylesheet" href="_static/default.css" type="text/css"/>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css"/>

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT: '',
            VERSION: '0',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE: true
        };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="クラウド実践演習 0 documentation" href="index.html"/>
    <link rel="next" title="Deployイメージセットアップ手順書" href="deploy.html"/>
    <link rel="prev" title="Browserイメージセットアップ手順書" href="browser.html"/>
</head>
<body>
<div class="related">
    <h3>Navigation</h3>
    <ul>
        <li class="right" style="margin-right: 10px">
            <a href="genindex.html" title="General Index"
               accesskey="I">index</a></li>
        <li class="right">
            <a href="deploy.html" title="Deployイメージセットアップ手順書"
               accesskey="N">next</a> |
        </li>
        <li class="right">
            <a href="browser.html" title="Browserイメージセットアップ手順書"
               accesskey="P">previous</a> |
        </li>
        <li><a href="index.html">クラウド実践演習 0 documentation</a> &raquo;</li>
    </ul>
</div>

<div class="document">
    <div class="documentwrapper">
        <div class="bodywrapper">
            <div class="body">

                <div class="section" id="db">
                    <h1>DBイメージセットアップ手順書<a class="headerlink" href="#db" title="Permalink to this headline">¶</a></h1>
                    <div class="section" id="id1">
                        <h2>はじめに<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
                        <div class="highlight-python">
                            <pre>この手順書は、本演習で使用するDBイメージを作成する手順である</pre>
                        </div>
                    </div>
                    <div class="section" id="id2">
                        <h2>前提条件<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
                        <ul class="simple">
                            <li>Baseイメージセットアップ手順書に従ってBaseイメージが作成されていること</li>
                        </ul>
                    </div>
                    <div class="section" id="id3">
                        <h2>パッケージのインストールと設定<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a>
                        </h2>
                    </div>
                    <div class="section" id="mysql">
                        <h2>mysql<a class="headerlink" href="#mysql" title="Permalink to this headline">¶</a></h2>
                        <div class="section" id="id4">
                            <h3>インストール<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
                            <div class="highlight-python">
                                <div class="highlight"><pre><span class="c"># apt-get install mysql-server</span>
</pre>
                                </div>
                            </div>
                        </div>
                        <div class="section" id="id5">
                            <h3>設定<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
                            <p>caracterの設定をする</p>
                            <div class="highlight-python">
                                <div class="highlight"><pre><span class="c"># vi /etc/mysql/my.cnf default-character-set=utf8</span>
<span class="n">skip</span><span class="o">-</span><span class="n">character</span><span class="o">-</span><span
                                            class="nb">set</span><span class="o">-</span><span
                                            class="n">client</span><span class="o">-</span><span
                                            class="n">handshake</span>
</pre>
                                </div>
                            </div>
                            <div class="highlight-python"><pre>bind-address            = 0.0.0.0
[mysqldump]
default-character-set=utf8
[mysql]
default-character-set=utf8</pre>
                            </div>
                            <p>掲示板アプリケーションが使用するdatabaseを作成する</p>
                            <div class="highlight-python"><pre># mysql -u root
create database keijiban; GRANT ALL PRIVILEGES ON *.* TO nii IDENTIFIED
BY 'nii' WITH GRANT OPTION; use keijiban DROP TABLE ``articles``; CREATE
TABLE ``articles`` ( ``id`` int(11) NOT NULL AUTO\_INCREMENT,
``user_id`` int(11) NULL DEFAULT NULL, ``name`` varchar(255) NULL
DEFAULT NULL, ``subject`` varchar(255) NULL DEFAULT NULL, ``body`` TEXT
NULL DEFAULT NULL, ``created_at`` Timestamp NULL DEFAULT NULL,
``updated_at`` Timestamp NULL DEFAULT NULL, PRIMARY KEY (``id``) )
ENGINE=InnoDB DEFAULT CHARSET=utf8;</pre>
                            </div>
                            <div class="highlight-python"><pre>DROP TABLE `comments`;
CREATE TABLE `comments` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `article_id` int(11) NOT NULL,
  `user_id` int(11) NULL DEFAULT NULL,
  `name` varchar(255) NULL DEFAULT NULL,
  `subject` varchar(255) NULL DEFAULT NULL,
  `body` TEXT NULL DEFAULT NULL,
  `created_at` Timestamp NULL DEFAULT NULL,
  `updated_at` Timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

DROP TABLE `users`;
CREATE TABLE `users` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NULL DEFAULT NULL,
  `email` varchar(255) NOT NULL,
  `password` varchar(255) NULL DEFAULT NULL,
  `registered_flag` tinyint(1) NOT NULL DEFAULT 0,
  `token` varchar(255) NULL DEFAULT NULL,
  `created_at` Timestamp NULL DEFAULT NULL,
  `updated_at` Timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;</pre>
                            </div>
                        </div>
                    </div>
                    <div class="section" id="puppet">
                        <h2>puppet<a class="headerlink" href="#puppet" title="Permalink to this headline">¶</a></h2>
                        <div class="section" id="id6">
                            <h3>設定<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
                            <p>puppet agentのプロセスを起動できるようにする</p>
                            <div class="highlight-python">
                                <div class="highlight"><pre><span class="c"># vi /etc/default puppet</span>
<span class="n">START</span><span class="o">=</span><span class="n">yes</span>
</pre>
                                </div>
                            </div>
                            <div class="highlight-python">
                                <div class="highlight"><pre><span class="c"># rm -rf /var/lib/puppt/ssl</span>
</pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="section" id="id7">
                        <h2>サービスの無効化<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
                        <div class="section" id="id8">
                            <h3>設定<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
                            <p>不必要なサービスを無効化する</p>
                            <div class="highlight-python">
                                <div class="highlight"><pre><span class="c"># /etc/init.d/puppetmaster stop</span>
<span class="c"># /etc/init.d/stompserver stop</span>
<span class="c"># /etc/init.d/mcollective stop</span>
</pre>
                                </div>
                            </div>
                            <div class="highlight-python">
                                <div class="highlight"><pre><span class="c"># update-rc.d -f puppetmaster remove</span>
<span class="c"># update-rc.d -f puppet remove</span>
<span class="c"># update-rc.d -f mcollective remove</span>
<span class="c"># update-rc.d -f stompserver remove</span>
</pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="section" id="startup">
                        <h2>　startupスクリプトの設定<a class="headerlink" href="#startup"
                                               title="Permalink to this headline">¶</a></h2>
                    </div>
                    <div class="section" id="rc-local">
                        <h2>rc.local<a class="headerlink" href="#rc-local" title="Permalink to this headline">¶</a></h2>
                        <div class="section" id="id9">
                            <h3>設定<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
                            <div class="highlight-python"><pre># vi /etc/rc.local
/root/work/setup/startup.sh db</pre>
                            </div>
                        </div>
                    </div>
                </div>


            </div>
        </div>
    </div>
    <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
                <li><a class="reference internal" href="#">DBイメージセットアップ手順書</a>
                    <ul>
                        <li><a class="reference internal" href="#id1">はじめに</a></li>
                        <li><a class="reference internal" href="#id2">前提条件</a></li>
                        <li><a class="reference internal" href="#id3">パッケージのインストールと設定</a></li>
                        <li><a class="reference internal" href="#mysql">mysql</a>
                            <ul>
                                <li><a class="reference internal" href="#id4">インストール</a></li>
                                <li><a class="reference internal" href="#id5">設定</a></li>
                            </ul>
                        </li>
                        <li><a class="reference internal" href="#puppet">puppet</a>
                            <ul>
                                <li><a class="reference internal" href="#id6">設定</a></li>
                            </ul>
                        </li>
                        <li><a class="reference internal" href="#id7">サービスの無効化</a>
                            <ul>
                                <li><a class="reference internal" href="#id8">設定</a></li>
                            </ul>
                        </li>
                        <li><a class="reference internal" href="#startup">　startupスクリプトの設定</a></li>
                        <li><a class="reference internal" href="#rc-local">rc.local</a>
                            <ul>
                                <li><a class="reference internal" href="#id9">設定</a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="browser.html"
                                  title="previous chapter">Browserイメージセットアップ手順書</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="deploy.html"
                                  title="next chapter">Deployイメージセットアップ手順書</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
                <li><a href="_sources/db.txt"
                       rel="nofollow">Show Source</a></li>
            </ul>
            <div id="searchbox" style="display: none">
                <h3>Quick search</h3>
                <form class="search" action="search.html" method="get">
                    <input type="text" name="q"/>
                    <input type="submit" value="Go"/>
                    <input type="hidden" name="check_keywords" value="yes"/>
                    <input type="hidden" name="area" value="default"/>
                </form>
                <p class="searchtip" style="font-size: 90%">
                    Enter search terms or a module, class or function name.
                </p>
            </div>
            <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
    </div>
    <div class="clearer"></div>
</div>
<div class="related">
    <h3>Navigation</h3>
    <ul>
        <li class="right" style="margin-right: 10px">
            <a href="genindex.html" title="General Index"
            >index</a></li>
        <li class="right">
            <a href="deploy.html" title="Deployイメージセットアップ手順書"
            >next</a> |
        </li>
        <li class="right">
            <a href="browser.html" title="Browserイメージセットアップ手順書"
            >previous</a> |
        </li>
        <li><a href="index.html">クラウド実践演習 0 documentation</a> &raquo;</li>
    </ul>
</div>
<div class="footer">
    &copy; Copyright 2012, Nii.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
</div>
</body>
</html>